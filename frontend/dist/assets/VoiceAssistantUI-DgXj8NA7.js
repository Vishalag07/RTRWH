import{u as e,r as t,j as s,o as a,ae as n,af as i,ag as r,g as c}from"./react-vendor-BIG0dXTf.js";import{A as o,m as l}from"./framer-motion-CjfoqxEY.js";function d(s,a={}){const{t:n,i18n:i}=e(),[r,c]=t.useState(!1),[o,l]=t.useState(""),[d,u]=t.useState(""),[m,x]=t.useState(0),[h,g]=t.useState(!1),[b,p]=t.useState(""),v=t.useRef(null),f=t.useRef(),j=t.useRef(null);t.useEffect(()=>{var e,t,s,r;const c=window.SpeechRecognition||window.webkitSpeechRecognition;return c?(g(!0),v.current=new c,v.current.continuous=null==(e=a.continuous)||e,v.current.interimResults=null==(t=a.interimResults)||t,v.current.lang=null!=(r=null!=(s=a.language)?s:i.language)?r:"en-US",v.current.maxAlternatives=3,"speechSynthesis"in window&&(j.current=window.speechSynthesis)):(g(!1),p(n("voice_assistant.not_supported"))),()=>{v.current&&v.current.stop(),f.current&&clearTimeout(f.current)}},[a,i.language,n]);const w=t.useCallback(e=>{if(j.current&&"speechSynthesis"in window){const t=j.current.speaking;t&&j.current.cancel(),setTimeout(()=>{var t;const s=new SpeechSynthesisUtterance(e);s.lang="bn"===i.language?"bn-BD":"en-US",s.rate=.9,s.pitch=1,s.volume=.8;const a=(null==(t=j.current)?void 0:t.getVoices())||[],n=a.find(e=>e.lang.startsWith(s.lang))||a[0];n&&(s.voice=n),j.current&&j.current.speak(s)},t?50:0)}},[i.language]),_=t.useCallback(e=>{const t=e.toLowerCase().trim();u(e);let a=!1;for(const[r,c]of Object.entries(s)){const e=r.toLowerCase();if(t===e||t.includes(e))try{c(...t.replace(e,"").trim().split(" ").filter(Boolean));const s=n("voice_assistant.command_executed",{command:r});l(s),w(s),a=!0;break}catch(i){const e=n("voice_assistant.command_error");l(e),w(e)}}if(!a){const e=n("voice_assistant.command_not_found");l(e),w(e)}f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{l(""),u("")},5e3)},[s,n,w]);t.useEffect(()=>{if(!v.current)return;const e=v.current;e.onstart=()=>{p(""),l(n("voice_assistant.listening_started"))},e.onresult=e=>{let t="",s="";for(let a=e.resultIndex;a<e.results.length;a++){const n=e.results[a],i=n[0].transcript;n.isFinal?(t+=i,x(n[0].confidence)):s+=i}t?_(t):s&&u(s)},e.onerror=e=>{let t="";switch(e.error){case"no-speech":t=n("voice_assistant.no_speech");break;case"audio-capture":t=n("voice_assistant.no_microphone");break;case"not-allowed":t=n("voice_assistant.permission_denied");break;case"network":t=n("voice_assistant.network_error");break;default:t=n("voice_assistant.recognition_error")}p(t),l(t),c(!1)},e.onend=()=>{c(!1),b||l(n("voice_assistant.listening_stopped"))}},[_,n,b]);const y=t.useCallback(()=>{if(h&&v.current)try{p(""),u(""),x(0),v.current.start(),c(!0)}catch(e){p(n("voice_assistant.start_error"))}else p(n("voice_assistant.not_supported"))},[h,n]),N=t.useCallback(()=>{v.current&&v.current.stop(),c(!1)},[]),k=t.useCallback(()=>{r?N():y()},[r,y,N]);return{isListening:r,setIsListening:k,feedback:o,transcript:d,confidence:m,isSupported:h,error:b,startListening:y,stopListening:N,speak:w}}const u=({isListening:d,setIsListening:u,feedback:m,onClose:x})=>{const{t:h}=e(),[g,b]=t.useState(!1),[p,v]=t.useState(""),[f,j]=t.useState(0);return s.jsx(o,{children:s.jsxs(l.div,{className:"fixed bottom-6 right-6 z-50",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},transition:{duration:.3},children:[s.jsx(o,{children:g&&s.jsxs(l.div,{className:"absolute bottom-20 right-0 w-80 bg-white/95 backdrop-blur-lg border border-white/50 rounded-2xl shadow-2xl overflow-hidden",initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.9},transition:{duration:.3},children:[s.jsxs("div",{className:"flex items-center justify-between p-4 bg-gradient-to-r from-blue-500/10 to-cyan-500/10 border-b border-white/20",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(l.div,{className:"w-3 h-3 bg-green-500 rounded-full",animate:d?{scale:[1,1.2,1]}:{},transition:{duration:1,repeat:1/0}}),s.jsx("span",{className:"font-semibold text-slate-800",children:h("voice_assistant.title")})]}),s.jsx("button",{onClick:()=>{u(!1),b(!1),x&&x()},className:"p-1 hover:bg-white/50 rounded-lg transition-colors","aria-label":h("voice_assistant.close"),children:s.jsx(a,{className:"w-4 h-4 text-slate-600"})})]}),s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsx("div",{className:"text-center",children:s.jsx(l.div,{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium "+(d?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"),animate:d?{scale:[1,1.05,1]}:{},transition:{duration:1,repeat:1/0},children:d?s.jsxs(s.Fragment,{children:[s.jsx(n,{className:"w-4 h-4"}),h("voice_assistant.listening")]}):s.jsxs(s.Fragment,{children:[s.jsx(i,{className:"w-4 h-4"}),h("voice_assistant.not_listening")]})})}),p&&s.jsxs(l.div,{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:[s.jsx("div",{className:"text-sm text-blue-800 font-medium mb-1",children:h("voice_assistant.transcript")}),s.jsx("div",{className:"text-blue-700",children:p}),f>0&&s.jsx("div",{className:"mt-2",children:s.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-600",children:[s.jsx("span",{children:h("voice_assistant.confidence")}),s.jsx("div",{className:"flex-1 bg-blue-200 rounded-full h-1",children:s.jsx(l.div,{className:"bg-blue-500 h-1 rounded-full",initial:{width:0},animate:{width:100*f+"%"},transition:{duration:.5}})}),s.jsxs("span",{children:[Math.round(100*f),"%"]})]})})]}),m&&s.jsx(l.div,{className:"bg-green-50 border border-green-200 rounded-lg p-3",initial:{opacity:0,y:10},animate:{opacity:1,y:0},children:s.jsxs("div",{className:"flex items-center gap-2 text-green-700",children:[s.jsx(r,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:m})]})}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[s.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:h("voice_assistant.available_commands")}),s.jsxs("div",{className:"space-y-1 text-xs text-gray-600",children:[s.jsxs("div",{children:['• "',h("voice_commands.navigate_to_dashboard"),'"']}),s.jsxs("div",{children:['• "',h("voice_commands.navigate_to_assessment"),'"']}),s.jsxs("div",{children:['• "',h("voice_commands.login"),'"']}),s.jsxs("div",{children:['• "',h("voice_commands.register"),'"']})]})]}),s.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-gray-200",children:[s.jsx("button",{onClick:()=>{u(!d),d||b(!0)},className:"flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all "+(d?"bg-red-500 hover:bg-red-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"),children:d?s.jsxs(s.Fragment,{children:[s.jsx(i,{className:"w-4 h-4"}),h("voice_assistant.stop")]}):s.jsxs(s.Fragment,{children:[s.jsx(n,{className:"w-4 h-4"}),h("voice_assistant.start")]})}),s.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-lg transition-colors","aria-label":h("voice_assistant.settings"),children:s.jsx(c,{className:"w-4 h-4 text-gray-600"})})]})]})]})}),s.jsxs(l.button,{onClick:()=>b(!g),className:"relative w-16 h-16 rounded-full shadow-2xl flex items-center justify-center transition-all duration-300 "+(d?"bg-gradient-to-r from-red-500 to-red-600 text-white":"bg-gradient-to-r from-blue-500 to-cyan-500 text-white hover:from-blue-600 hover:to-cyan-600"),whileHover:{scale:1.1},whileTap:{scale:.95},"aria-label":h("voice_assistant.toggle"),children:[d&&s.jsx(l.div,{className:"absolute inset-0 rounded-full bg-red-400",animate:{scale:[1,1.5,1],opacity:[.7,0,.7]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"}}),s.jsx(l.div,{animate:d?{scale:[1,1.1,1]}:{},transition:{duration:.5,repeat:1/0},children:d?s.jsx(i,{className:"w-6 h-6"}):s.jsx(n,{className:"w-6 h-6"})})]}),!g&&m&&s.jsx(l.div,{className:"absolute bottom-20 right-0 bg-black/80 text-white text-sm px-3 py-2 rounded-lg whitespace-nowrap max-w-xs",initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},children:m})]})})};export{u as V,d as u};
