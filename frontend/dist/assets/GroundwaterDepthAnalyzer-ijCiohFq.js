import{u as e,k as a,r as t,j as l,L as s,ah as i,ai as n,aj as r,ak as d,al as o,am as c,an as m}from"./react-vendor-CJ3VGwWI.js";/* empty css                */import{b as u}from"./index-ZW20BDBo.js";import{A as g,m as x}from"./framer-motion-C2hfdD_N.js";import"./vendor-wFsWlTaG.js";function h(e){return e<=2?"#8ecae6":e<=10?"#219ebc":e<=25?"#023e8a":"#d90429"}function p({onClick:e}){return m({click:a=>e(a.latlng.lat,a.latlng.lng)}),null}function b(){var m;const{t:b}=e(),[_,v]=(a(),t.useState([{lat:12.9716,lon:77.5946,groundwater_level_m:8,location:"Bengaluru Urban"},{lat:28.6139,lon:77.209,groundwater_level_m:35,location:"New Delhi"}])),[j,y]=t.useState(22.5),[f,N]=t.useState(77),[w,k]=t.useState(100),[S,C]=t.useState(5e3),[F,H]=t.useState(1e3),[L,O]=t.useState(7),[P,z]=t.useState(null),[A,D]=t.useState(!1),[M,$]=t.useState(null),[B,E]=t.useState(null);t.useRef(null);const[R,U]=t.useState(!0),[q,G]=t.useState(!0),I=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{y(Number(e.coords.latitude.toFixed(5))),N(Number(e.coords.longitude.toFixed(5)))},()=>{$(b("gda.gps_error"))},{enableHighAccuracy:!0,timeout:5e3})};t.useEffect(()=>{I()},[]);const J=e=>{return a=this,t=null,l=function*(){var a,t;e&&e.preventDefault(),D(!0),$(null),z(null),E(b("gda.progress_starting"));try{const e=yield u.post("/rain-prediction/predict",{latitude:j,longitude:f,roof_area_m2:w,tank_capacity_liters:S,current_tank_level_liters:F,forecast_days:L});e.data.result?(z(e.data.result),E(b("gda.progress_immediate"))):e.data&&z(e.data)}catch(l){$((null==(t=null==(a=null==l?void 0:l.response)?void 0:a.data)?void 0:t.detail)||(null==l?void 0:l.message)||b("gda.prediction_failed"))}finally{D(!1)}},new Promise((s,i)=>{var n=a=>{try{d(l.next(a))}catch(e){i(e)}},r=a=>{try{d(l.throw(a))}catch(e){i(e)}},d=e=>e.done?s(e.value):Promise.resolve(e.value).then(n,r);d((l=l.apply(a,t)).next())});var a,t,l};return b("voice_commands.set_latitude"),b("voice_commands.set_longitude"),b("voice_commands.set_roof_area"),b("voice_commands.set_tank_capacity"),b("voice_commands.predict"),b("voice_commands.use_gps"),b("voice_commands.toggle_heatmap"),b("voice_commands.toggle_markers"),b("voice_commands.go_home"),l.jsx(g,{children:l.jsxs(x.div,{className:"p-6 space-y-6 bg-gray-50 min-h-screen",initial:{opacity:0},animate:{opacity:1},children:[l.jsxs("header",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:b("gda.title")}),l.jsx("p",{className:"text-base text-gray-600 mt-1",children:b("gda.subtitle")})]}),l.jsx("div",{className:"flex items-center gap-4",children:l.jsx(s,{to:"/dashboard",className:"text-blue-600 hover:underline",children:b("gda.back_to_dashboard")})})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs(x.section,{className:"bg-white rounded-2xl p-2 shadow-lg border",initial:{opacity:0,x:-30},animate:{opacity:1,x:0},transition:{delay:.1},children:[l.jsx("h2",{className:"px-3 py-2 font-semibold text-gray-700",children:b("gda.map_title")}),l.jsx("div",{style:{height:520},className:"rounded-b-xl overflow-hidden",role:"application","aria-label":b("aria.gda_map"),children:l.jsxs(i,{center:[j,f],zoom:6,style:{height:"100%",width:"100%"},children:[l.jsx(n,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:b("gda.map_attribution")}),q&&_.map((e,a)=>l.jsx(r,{center:[e.lat,e.lon],radius:12,pathOptions:{color:e.groundwater_level_m<=10?"#2b9348":e.groundwater_level_m<=30?"#f6c90e":"#d00000"},children:l.jsxs(d,{children:[e.location||`${e.lat.toFixed(3)}, ${e.lon.toFixed(3)}`,": ",e.groundwater_level_m," m"]})},a)),R&&(null==(m=null==P?void 0:P.daily)?void 0:m.length)&&P.daily.map((e,a)=>l.jsx(o,{center:[j+.0015*(a-P.daily.length/2),f+.0015*(a-P.daily.length/2)],radius:10*Math.min(80,Math.max(6,4*e.rainfall_mm)),pathOptions:{color:h(e.rainfall_mm),fillColor:h(e.rainfall_mm),fillOpacity:.18}},a)),l.jsx(p,{onClick:(e,a)=>{y(Number(e.toFixed(5))),N(Number(a.toFixed(5)))}}),l.jsx(c,{position:[j,f],draggable:!0,eventHandlers:{dragend:e=>{const a=e.target.getLatLng();y(Number(a.lat.toFixed(5))),N(Number(a.lng.toFixed(5)))}},children:l.jsx(d,{children:b("gda.selected_location_popup")})})]})})]}),l.jsxs(x.aside,{className:"space-y-4",initial:{opacity:0,x:30},animate:{opacity:1,x:0},transition:{delay:.15},children:[l.jsxs("form",{className:"bg-white rounded-2xl p-4 shadow-lg border",onSubmit:J,children:[l.jsx("h3",{className:"font-semibold mb-3 text-gray-700",children:b("gda.controls_title")}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold",children:b("gda.latitude")}),l.jsx("input",{type:"number",step:"any",value:j,onChange:e=>y(Number(e.target.value)),className:"input input-bordered w-full","aria-label":b("aria.gda_latitude")})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold",children:b("gda.longitude")}),l.jsx("input",{type:"number",step:"any",value:f,onChange:e=>N(Number(e.target.value)),className:"input input-bordered w-full","aria-label":b("aria.gda_longitude")})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold",children:b("gda.forecast_days")}),l.jsx("input",{type:"range",min:1,max:14,value:L,onChange:e=>O(Number(e.target.value)),className:"w-full"}),l.jsxs("div",{className:"text-xs text-gray-600",children:[L," ",b("gda.days")]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold",children:b("gda.roof_area")}),l.jsx("input",{type:"number",min:1,value:w,onChange:e=>k(Number(e.target.value)),className:"input input-bordered w-full","aria-label":b("aria.gda_roof_area")})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold",children:b("gda.tank_capacity")}),l.jsx("input",{type:"number",min:1,value:S,onChange:e=>C(Number(e.target.value)),className:"input input-bordered w-full","aria-label":b("aria.gda_tank_capacity")})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-semibold",children:b("gda.current_tank_level")}),l.jsx("input",{type:"number",min:0,value:F,onChange:e=>H(Number(e.target.value)),className:"input input-bordered w-full","aria-label":b("aria.gda_current_tank")})]})]}),l.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[l.jsx(x.button,{type:"button",whileHover:{scale:1.05},onClick:I,className:"btn btn-outline",children:b("gda.use_gps_button")}),l.jsx(x.button,{type:"submit",whileHover:{scale:1.05},className:"btn btn-primary",disabled:A,children:b(A?"gda.predicting":"gda.predict_button")})]}),B&&l.jsxs("div",{className:"mt-3 text-xs text-gray-600",children:[b("gda.transmission_label"),": ",B]}),M&&l.jsx("div",{className:"text-red-600 mt-3",children:M})]}),l.jsxs(x.div,{className:"bg-white rounded-2xl p-4 shadow-lg border",children:[l.jsx("h3",{className:"font-semibold text-gray-700",children:b("gda.results_title")}),!P&&l.jsx("div",{className:"text-sm text-gray-500 mt-3",children:b("gda.no_prediction_text")}),P&&l.jsx("div",{className:"mt-3 space-y-2 text-sm",children:P.summary&&l.jsx("p",{children:P.summary})})]}),l.jsxs("div",{className:"flex gap-2 items-center",children:[l.jsx(x.button,{whileHover:{scale:1.1},className:"btn btn-sm btn-accent",onClick:()=>{U(e=>!e)},children:b(R?"gda.hide_heatmap":"gda.show_heatmap")}),l.jsx(x.button,{whileHover:{scale:1.1},className:"btn btn-sm btn-info",onClick:()=>{G(e=>!e)},children:b(q?"gda.hide_markers":"gda.show_markers")})]})]})]})]})})}export{b as GroundwaterDepthAnalyzer,b as default};
