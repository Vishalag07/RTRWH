import{u as e,e as a,r as t,j as s,L as l,a7 as i,a8 as n,a9 as r,aa as o,ab as d,ac as c,ad as m}from"./react-vendor-BIG0dXTf.js";/* empty css                */import{a as u}from"./api-CUAgWf1P.js";import{L as g}from"./index-DdHcYEUd.js";import{u as x,V as p}from"./VoiceAssistantUI-DgXj8NA7.js";import{A as h,m as b}from"./framer-motion-CjfoqxEY.js";import"./vendor-B0m_Fmqf.js";function _(e){return e<=2?"#8ecae6":e<=10?"#219ebc":e<=25?"#023e8a":"#d90429"}function v({onClick:e}){return m({click:a=>e(a.latlng.lat,a.latlng.lng)}),null}function j(){var m;const{t:j}=e(),f=a(),[y,N]=t.useState([{lat:12.9716,lon:77.5946,groundwater_level_m:8,location:"Bengaluru Urban"},{lat:28.6139,lon:77.209,groundwater_level_m:35,location:"New Delhi"}]),[w,k]=t.useState(22.5),[S,C]=t.useState(77),[F,L]=t.useState(100),[H,A]=t.useState(5e3),[I,O]=t.useState(1e3),[P,z]=t.useState(7),[D,M]=t.useState(null),[U,V]=t.useState(!1),[$,B]=t.useState(null),[E,R]=t.useState(null);t.useRef(null);const[q,G]=t.useState(!0),[J,K]=t.useState(!0),Q=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{k(Number(e.coords.latitude.toFixed(5))),C(Number(e.coords.longitude.toFixed(5)))},()=>{B(j("gda.gps_error"))},{enableHighAccuracy:!0,timeout:5e3})};t.useEffect(()=>{Q()},[]);const T=e=>{return a=this,t=null,s=function*(){var a,t;e&&e.preventDefault(),V(!0),B(null),M(null),R(j("gda.progress_starting"));try{const e=yield u.post("/rain-prediction/predict",{latitude:w,longitude:S,roof_area_m2:F,tank_capacity_liters:H,current_tank_level_liters:I,forecast_days:P});e.data.result?(M(e.data.result),R(j("gda.progress_immediate"))):e.data&&M(e.data)}catch(s){B((null==(t=null==(a=null==s?void 0:s.response)?void 0:a.data)?void 0:t.detail)||(null==s?void 0:s.message)||j("gda.prediction_failed"))}finally{V(!1)}},new Promise((l,i)=>{var n=a=>{try{o(s.next(a))}catch(e){i(e)}},r=a=>{try{o(s.throw(a))}catch(e){i(e)}},o=e=>e.done?l(e.value):Promise.resolve(e.value).then(n,r);o((s=s.apply(a,t)).next())});var a,t,s},W={[j("voice_commands.set_latitude")]:e=>k(parseFloat(e)),[j("voice_commands.set_longitude")]:e=>C(parseFloat(e)),[j("voice_commands.set_roof_area")]:e=>L(parseFloat(e)),[j("voice_commands.set_tank_capacity")]:e=>A(parseFloat(e)),[j("voice_commands.predict")]:()=>T(),[j("voice_commands.use_gps")]:Q,[j("voice_commands.toggle_heatmap")]:()=>G(e=>!e),[j("voice_commands.toggle_markers")]:()=>K(e=>!e),[j("voice_commands.go_home")]:()=>f("/")},{isListening:X,setIsListening:Y,feedback:Z}=x(W);return s.jsx(h,{children:s.jsxs(b.div,{className:"p-6 space-y-6 bg-gray-50 min-h-screen",initial:{opacity:0},animate:{opacity:1},children:[s.jsxs("header",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:j("gda.title")}),s.jsx("p",{className:"text-base text-gray-600 mt-1",children:j("gda.subtitle")})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(l,{to:"/dashboard",className:"text-blue-600 hover:underline",children:j("gda.back_to_dashboard")}),s.jsx(g,{})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs(b.section,{className:"bg-white rounded-2xl p-2 shadow-lg border",initial:{opacity:0,x:-30},animate:{opacity:1,x:0},transition:{delay:.1},children:[s.jsx("h2",{className:"px-3 py-2 font-semibold text-gray-700",children:j("gda.map_title")}),s.jsx("div",{style:{height:520},className:"rounded-b-xl overflow-hidden",role:"application","aria-label":j("aria.gda_map"),children:s.jsxs(i,{center:[w,S],zoom:6,style:{height:"100%",width:"100%"},children:[s.jsx(n,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:j("gda.map_attribution")}),J&&y.map((e,a)=>s.jsx(r,{center:[e.lat,e.lon],radius:12,pathOptions:{color:e.groundwater_level_m<=10?"#2b9348":e.groundwater_level_m<=30?"#f6c90e":"#d00000"},children:s.jsxs(o,{children:[e.location||`${e.lat.toFixed(3)}, ${e.lon.toFixed(3)}`,": ",e.groundwater_level_m," m"]})},a)),q&&(null==(m=null==D?void 0:D.daily)?void 0:m.length)&&D.daily.map((e,a)=>s.jsx(d,{center:[w+.0015*(a-D.daily.length/2),S+.0015*(a-D.daily.length/2)],radius:10*Math.min(80,Math.max(6,4*e.rainfall_mm)),pathOptions:{color:_(e.rainfall_mm),fillColor:_(e.rainfall_mm),fillOpacity:.18}},a)),s.jsx(v,{onClick:(e,a)=>{k(Number(e.toFixed(5))),C(Number(a.toFixed(5)))}}),s.jsx(c,{position:[w,S],draggable:!0,eventHandlers:{dragend:e=>{const a=e.target.getLatLng();k(Number(a.lat.toFixed(5))),C(Number(a.lng.toFixed(5)))}},children:s.jsx(o,{children:j("gda.selected_location_popup")})})]})})]}),s.jsxs(b.aside,{className:"space-y-4",initial:{opacity:0,x:30},animate:{opacity:1,x:0},transition:{delay:.15},children:[s.jsxs("form",{className:"bg-white rounded-2xl p-4 shadow-lg border",onSubmit:T,children:[s.jsx("h3",{className:"font-semibold mb-3 text-gray-700",children:j("gda.controls_title")}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold",children:j("gda.latitude")}),s.jsx("input",{type:"number",step:"any",value:w,onChange:e=>k(Number(e.target.value)),className:"input input-bordered w-full","aria-label":j("aria.gda_latitude")})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold",children:j("gda.longitude")}),s.jsx("input",{type:"number",step:"any",value:S,onChange:e=>C(Number(e.target.value)),className:"input input-bordered w-full","aria-label":j("aria.gda_longitude")})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold",children:j("gda.forecast_days")}),s.jsx("input",{type:"range",min:1,max:14,value:P,onChange:e=>z(Number(e.target.value)),className:"w-full"}),s.jsxs("div",{className:"text-xs text-gray-600",children:[P," ",j("gda.days")]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold",children:j("gda.roof_area")}),s.jsx("input",{type:"number",min:1,value:F,onChange:e=>L(Number(e.target.value)),className:"input input-bordered w-full","aria-label":j("aria.gda_roof_area")})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold",children:j("gda.tank_capacity")}),s.jsx("input",{type:"number",min:1,value:H,onChange:e=>A(Number(e.target.value)),className:"input input-bordered w-full","aria-label":j("aria.gda_tank_capacity")})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-semibold",children:j("gda.current_tank_level")}),s.jsx("input",{type:"number",min:0,value:I,onChange:e=>O(Number(e.target.value)),className:"input input-bordered w-full","aria-label":j("aria.gda_current_tank")})]})]}),s.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[s.jsx(b.button,{type:"button",whileHover:{scale:1.05},onClick:Q,className:"btn btn-outline",children:j("gda.use_gps_button")}),s.jsx(b.button,{type:"submit",whileHover:{scale:1.05},className:"btn btn-primary",disabled:U,children:j(U?"gda.predicting":"gda.predict_button")})]}),E&&s.jsxs("div",{className:"mt-3 text-xs text-gray-600",children:[j("gda.transmission_label"),": ",E]}),$&&s.jsx("div",{className:"text-red-600 mt-3",children:$})]}),s.jsxs(b.div,{className:"bg-white rounded-2xl p-4 shadow-lg border",children:[s.jsx("h3",{className:"font-semibold text-gray-700",children:j("gda.results_title")}),!D&&s.jsx("div",{className:"text-sm text-gray-500 mt-3",children:j("gda.no_prediction_text")}),D&&s.jsx("div",{className:"mt-3 space-y-2 text-sm",children:D.summary&&s.jsx("p",{children:D.summary})})]}),s.jsxs("div",{className:"flex gap-2 items-center",children:[s.jsx(b.button,{whileHover:{scale:1.1},className:"btn btn-sm btn-accent",onClick:()=>{G(e=>!e)},children:j(q?"gda.hide_heatmap":"gda.show_heatmap")}),s.jsx(b.button,{whileHover:{scale:1.1},className:"btn btn-sm btn-info",onClick:()=>{K(e=>!e)},children:j(J?"gda.hide_markers":"gda.show_markers")})]})]})]}),s.jsx(p,{isListening:X,setIsListening:Y,feedback:Z})]})})}export{j as GroundwaterDepthAnalyzer,j as default};
