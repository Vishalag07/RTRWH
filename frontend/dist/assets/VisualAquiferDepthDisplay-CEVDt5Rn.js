var e=Object.defineProperty,t=Object.defineProperties,l=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,i=(t,l,a)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[l]=a,r=(e,t)=>{for(var l in t||(t={}))s.call(t,l)&&i(e,l,t[l]);if(a)for(var l of a(t))o.call(t,l)&&i(e,l,t[l]);return e},n=(e,a)=>t(e,l(a)),d=(e,t,l)=>new Promise((a,s)=>{var o=e=>{try{r(l.next(e))}catch(t){s(t)}},i=e=>{try{r(l.throw(e))}catch(t){s(t)}},r=e=>e.done?a(e.value):Promise.resolve(e.value).then(o,i);r((l=l.apply(e,t)).next())});import{r as c,j as m,u as h,k as x,L as f,m as p,a6 as u}from"./react-vendor-CJ3VGwWI.js";/* empty css                */import{C as g,O as b,H as y,M as j,a as v,u as _,T as w,b as S}from"./three-core-D5YSOkE8.js";import{E as N,g as k}from"./groundwaterApi-B2amRRkl.js";import{m as T}from"./framer-motion-C2hfdD_N.js";import"./vendor-wFsWlTaG.js";const P=(e,t)=>t?new j({color:e}):new v({color:e}),M=({layer:e,position:t,size:l,colorInfo:a,performanceMode:s,animationTime:o,onHover:i,onLeave:r})=>{const n=c.useRef(null),[d,h]=c.useState(!1),x=c.useMemo(()=>s?new j({color:a.primary,transparent:!0,opacity:.8}):new v({color:a.primary,transparent:!0,opacity:.9}),[a.primary,s]);_(()=>{if(n.current&&!s){const e=1+.02*Math.sin(.5*o);n.current.scale.setScalar(e);const t=.1*Math.sin(.3*o),l=new S(a.primary);l.offsetHSL(t,0,0),x.color=l}});return m.jsxs("group",{position:t,children:[m.jsxs("mesh",{ref:n,onPointerOver:()=>{h(!0),i()},onPointerOut:()=>{h(!1),r()},children:[m.jsx("boxGeometry",{args:l}),m.jsx("primitive",{object:x})]}),m.jsx(w,{position:[0,0,l[2]/2+.1],fontSize:.3,color:"white",anchorX:"center",anchorY:"middle",children:e.name}),m.jsx(y,{distanceFactor:10,children:m.jsxs("div",{className:"bg-black/70 text-white p-3 rounded-lg text-xs transition-all duration-300 "+(d?"scale-110 shadow-lg":""),children:[m.jsx("div",{className:"font-semibold text-yellow-300",children:e.name}),m.jsxs("div",{className:"text-gray-300",children:["Thickness: ",e.thickness_m.toFixed(1),"m"]}),m.jsxs("div",{className:"text-gray-300",children:["Permeability: ",(1e6*e.permeability).toFixed(2)," μm/s"]}),m.jsxs("div",{className:"text-gray-300",children:["Porosity: ",(100*e.porosity).toFixed(1),"%"]}),m.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[m.jsx("div",{className:"w-3 h-3 rounded-full border border-white",style:{backgroundColor:a.primary}}),m.jsx("span",{className:"text-xs text-gray-400",children:"Soil Color"})]})]})})]})},F=({position:e,size:t,animationTime:l})=>{const a=c.useRef(null);_(()=>{if(a.current){const e=a.current.geometry.attributes.position.array;for(let t=0;t<e.length;t+=3)e[t+2]=.1*Math.sin(.5*e[t]+l);a.current.geometry.attributes.position.needsUpdate=!0}});const s=c.useMemo(()=>new v({color:"#4A90E2",transparent:!0,opacity:.8}),[]);return m.jsx("mesh",{ref:a,position:e,material:s,children:m.jsx("planeGeometry",{args:t})})},C=({config:e,waterLevel:t,performanceMode:l,onHover:a,onLeave:s})=>{const o=c.useMemo(()=>P("#8B4513",l),[l]);return c.useMemo(()=>P("#4A90E2",l),[l]),m.jsxs("group",{position:e.position,children:[m.jsx("mesh",{material:o,onPointerOver:a,onPointerOut:s,children:m.jsx("cylinderGeometry",{args:[e.diameter_m/2,e.diameter_m/2,e.depth_m,8]})}),t>0&&m.jsxs("mesh",{position:[0,0,-e.depth_m/2+t/2],children:[m.jsx("cylinderGeometry",{args:[e.diameter_m/2-.1,e.diameter_m/2-.1,t,8]}),m.jsx("meshBasicMaterial",{color:"#4A90E2",transparent:!0,opacity:.8})]})]})},A=({config:e,waterLevel:t,performanceMode:l,onHover:a,onLeave:s})=>{const o=c.useMemo(()=>P("#654321",l),[l]);c.useMemo(()=>P("#4A90E2",l),[l]);return m.jsxs("group",{position:[2,0,0],children:[m.jsx("mesh",{material:o,onPointerOver:a,onPointerOut:s,children:m.jsx("cylinderGeometry",{args:[e.diameter_m/2,e.diameter_m/2,e.depth_m,8]})}),t>0&&m.jsxs("mesh",{position:[0,0,-e.depth_m/2+t/2],children:[m.jsx("cylinderGeometry",{args:[e.diameter_m/2-.1,e.diameter_m/2-.1,t,8]}),m.jsx("meshBasicMaterial",{color:"#4A90E2",transparent:!0,opacity:.8})]}),t>e.depth_m&&m.jsxs("mesh",{position:[0,0,.5],children:[(()=>{switch(e.size_category){case"small":default:return m.jsx("sphereGeometry",{args:[.5,8,6]});case"medium":return m.jsx("boxGeometry",{args:[2,.5,1]});case"large":return m.jsx("boxGeometry",{args:[4,.5,1]})}})(),m.jsx("meshBasicMaterial",{color:"#87CEEB",transparent:!0,opacity:.6})]})]})},L=({config:e,performanceMode:t,onHover:l,onLeave:a})=>{const s=c.useMemo(()=>P("#8B4513",t),[t]);return m.jsxs("group",{position:e.position,children:[m.jsx("mesh",{material:s,onPointerOver:l,onPointerOut:a,children:m.jsx("boxGeometry",{args:[e.width_m,e.length_m,e.height_m]})}),m.jsxs("mesh",{position:[0,0,e.height_m/2+.1],children:[m.jsx("boxGeometry",{args:[e.width_m+.2,e.length_m+.2,.2]}),m.jsx("meshBasicMaterial",{color:"#654321"})]})]})},D=({config:e,performanceMode:t,animationTime:l})=>{const a=c.useMemo(()=>P("#A0522D",t),[t]),s=c.useMemo(()=>{const e=[];for(let t=0;t<5;t++){const a=(2*l+.5*t)%2;e.push(m.jsxs("mesh",{position:[0,0,-a],children:[m.jsx("sphereGeometry",{args:[.02,6,4]}),m.jsx("meshBasicMaterial",{color:"#4A90E2",transparent:!0,opacity:.8})]},t))}return e},[l]);return m.jsxs("group",{position:[e.rooftop.position[0]+e.rooftop.width_m/2,0,e.rooftop.position[2]-e.rooftop.height_m/2],children:[m.jsxs("mesh",{rotation:[0,0,0],children:[m.jsx("cylinderGeometry",{args:[e.rooftop.pipe_diameter_m/2,e.rooftop.pipe_diameter_m/2,e.rooftop.pipe_length_m,8]}),m.jsx("primitive",{object:a})]}),m.jsxs("mesh",{position:[e.rooftop.pipe_length_m/2,0,-e.rooftop.pipe_length_m],rotation:[0,0,Math.PI/2],children:[m.jsx("cylinderGeometry",{args:[e.rooftop.pipe_diameter_m/2,e.rooftop.pipe_diameter_m/2,4,8]}),m.jsx("primitive",{object:a})]}),s]})},B=({performanceMode:e})=>{const t=c.useMemo(()=>P("#A0522D",e),[e]);return m.jsxs("mesh",{position:[1,0,-1],rotation:[0,0,Math.PI/2],children:[m.jsx("cylinderGeometry",{args:[.1,.1,2,6]}),m.jsx("primitive",{object:t})]})},E=({config:e,callbacks:t,performanceSettings:l,animationTime:a,waterLevel:s})=>{const[o,i]=c.useState(null),[r,n]=c.useState(null),d=e=>{var l;n(e),i("soil"),null==(l=t.onSelection)||l.call(t,"soil")},h=()=>{var e;i(null),n(null),null==(e=t.onSelection)||e.call(t,null)};let x=0;const f=e.soil_layers.map((e,t)=>{const s=[0,0,-x-e.thickness_m/2],o=[10,2,e.thickness_m];x+=e.thickness_m;const i=N[e.name]||{primary:e.color,secondary:e.color,highlight:e.color,shadow:e.color};return m.jsx(M,{layer:e,position:s,size:o,colorInfo:i,performanceMode:l.enablePerformanceMode,animationTime:a,onHover:d,onLeave:h},t)});return m.jsxs(m.Fragment,{children:[m.jsx("ambientLight",{intensity:.6}),m.jsx("directionalLight",{position:[10,10,5],intensity:.8}),m.jsxs("mesh",{position:[0,0,.1],children:[m.jsx("planeGeometry",{args:[20,8]}),m.jsx("meshLambertMaterial",{color:"#8FBC8F"})]}),m.jsx(L,{config:e.rooftop,performanceMode:l.enablePerformanceMode,onHover:()=>{var e;i("rooftop"),null==(e=t.onSelection)||e.call(t,"rooftop")},onLeave:h}),m.jsx(D,{config:e,performanceMode:l.enablePerformanceMode,animationTime:a}),f,m.jsx(F,{position:[0,0,-e.groundwater_depth_m],size:[10,2],animationTime:a}),m.jsx(C,{config:e.borewell,waterLevel:s,performanceMode:l.enablePerformanceMode,onHover:()=>{var e;i("borewell"),null==(e=t.onSelection)||e.call(t,"borewell")},onLeave:h}),m.jsx(A,{config:e.shaft,waterLevel:s,performanceMode:l.enablePerformanceMode,onHover:()=>{var e;i("shaft"),null==(e=t.onSelection)||e.call(t,"shaft")},onLeave:h}),m.jsx(B,{performanceMode:l.enablePerformanceMode}),r&&m.jsx(y,{position:[0,2,0],center:!0,children:m.jsxs("div",{className:"bg-black text-white p-2 rounded text-sm max-w-xs",children:[m.jsx("div",{className:"font-bold",children:r.name}),m.jsxs("div",{children:["Permeability: ",r.permeability]}),m.jsxs("div",{children:["Porosity: ",r.porosity]})]})})]})},W=({config:e,callbacks:t={},performanceSettings:l={}})=>{const[a,s]=c.useState(0),[o,i]=c.useState(e.groundwater_depth_m),[d,h]=c.useState(!0),[x,f]=c.useState(null),p=r({enablePerformanceMode:!1,maxPolygons:1e4,textureSize:512,enableLOD:!0,enableWaterShader:!0},l);c.useEffect(()=>{if(!d)return;const l=setInterval(()=>{var l;s(e=>e+.1);const o=a%10/10,r=e.groundwater_depth_m+2*Math.sin(o*Math.PI*2);i(r),null==(l=t.onLevelChange)||l.call(t,r)},100);return()=>clearInterval(l)},[d,a,e.groundwater_depth_m,t]);return m.jsxs("div",{className:"w-full h-full relative",children:[m.jsxs(g,{camera:{position:[8,8,8],fov:50},style:{background:"linear-gradient(to bottom, #87CEEB 0%, #98FB98 100%)"},performance:{min:.5},dpr:p.enablePerformanceMode?1:[1,2],children:[m.jsx(b,{enablePan:!0,enableZoom:!0,enableRotate:!0,maxPolarAngle:Math.PI/2,minDistance:5,maxDistance:20}),m.jsx(E,{config:e,callbacks:n(r({},t),{onSelection:e=>{var l;f(e),null==(l=t.onSelection)||l.call(t,e)}}),performanceSettings:p,animationTime:a,waterLevel:o})]}),m.jsx("div",{className:"absolute top-4 left-4 bg-black/70 text-white p-4 rounded-lg backdrop-blur-sm",children:m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("button",{onClick:()=>h(!d),className:"px-3 py-1 bg-blue-600 rounded hover:bg-blue-700",children:d?"⏸️":"▶️"}),m.jsx("span",{className:"text-sm",children:"Animation"})]}),m.jsxs("div",{children:[m.jsxs("label",{className:"text-sm block mb-1",children:["Water Level: ",o.toFixed(1),"m"]}),m.jsx("input",{type:"range",min:e.groundwater_depth_m-5,max:e.groundwater_depth_m+5,value:o,onChange:e=>{return l=parseFloat(e.target.value),i(l),void(null==(a=t.onLevelChange)||a.call(t,l));var l,a},className:"w-full"})]}),m.jsxs("div",{children:[m.jsxs("label",{className:"text-sm block mb-1",children:["Shaft Size: ",e.shaft.size_category]}),m.jsxs("select",{value:e.shaft.size_category,onChange:e=>{},className:"w-full bg-gray-700 text-white rounded px-2 py-1",children:[m.jsx("option",{value:"small",children:"Small"}),m.jsx("option",{value:"medium",children:"Medium"}),m.jsx("option",{value:"large",children:"Large"})]})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("input",{type:"checkbox",id:"performance",checked:p.enablePerformanceMode,onChange:e=>{}}),m.jsx("label",{htmlFor:"performance",className:"text-sm",children:"Performance Mode"})]})]})}),x&&m.jsxs("div",{className:"absolute bottom-4 left-4 bg-black/70 text-white p-4 rounded-lg backdrop-blur-sm",children:[m.jsxs("h3",{className:"font-bold mb-2",children:["Selected: ",x]}),"rooftop"===x&&m.jsxs("div",{children:[m.jsxs("div",{children:["Size: ",e.rooftop.width_m,"m × ",e.rooftop.length_m,"m"]}),m.jsxs("div",{children:["Height: ",e.rooftop.height_m,"m"]}),m.jsxs("div",{children:["Pipe Diameter: ",e.rooftop.pipe_diameter_m,"m"]}),m.jsxs("div",{children:["Flow Rate: ",e.water_flow.flowRate," L/s"]})]}),"borewell"===x&&m.jsxs("div",{children:[m.jsxs("div",{children:["Depth: ",e.borewell.depth_m,"m"]}),m.jsxs("div",{children:["Diameter: ",e.borewell.diameter_m,"m"]}),m.jsxs("div",{children:["Water Level: ",o.toFixed(1),"m"]})]}),"shaft"===x&&m.jsxs("div",{children:[m.jsxs("div",{children:["Depth: ",e.shaft.depth_m,"m"]}),m.jsxs("div",{children:["Diameter: ",e.shaft.diameter_m,"m"]}),m.jsxs("div",{children:["Size: ",e.shaft.size_category]}),m.jsxs("div",{children:["Overflow: ",o>e.shaft.depth_m?"Yes":"No"]})]})]})]})},R=({config:e,callbacks:t={},waterLevel:l,animationTime:a,isPlaying:s,onLevelChange:o,onTogglePlay:i,enhancedSoilLayers:r=[],dataSource:n="Demo Data",isLoading:d=!1})=>{const h=c.useRef(null),[x,f]=c.useState(null),[p,u]=c.useState(null);c.useEffect(()=>{if(!s)return;const t=h.current;if(!t)return;const o=t.getContext("2d");if(!o)return;const i=()=>{o.clearRect(0,0,t.width,t.height);const c=window.devicePixelRatio||1;t.width=t.offsetWidth*c,t.height=t.offsetHeight*c,o.scale(c,c),t.style.width=t.offsetWidth+"px",t.style.height=t.offsetHeight+"px";const m=t.offsetWidth/2,h=t.offsetHeight/2,x=Math.min(t.offsetWidth,t.offsetHeight)/20;o.fillStyle="#8FBC8F",o.fillRect(0,h-50,t.offsetWidth,100);const f=m-200,p=e.rooftop.width_m*x,u=e.rooftop.height_m*x;o.fillStyle="#8B4513",o.fillRect(f-p/2,h-50-u,p,u),o.fillStyle="#654321",o.fillRect(f-p/2-5,h-50-u-10,p+10,10);const g=f+p/2,b=h-50-u/2,y=m-100,j=2.5*(e.shaft.diameter_m*x),v=Math.abs(y-j/2-g),_=o.createLinearGradient(g,b,g+v,b);_.addColorStop(0,"#8B4513"),_.addColorStop(.5,"#A0522D"),_.addColorStop(1,"#8B4513"),o.fillStyle=_,o.fillRect(g,b-3,v,6);const w=Math.abs(b-(h-30));if(o.fillRect(g+v-3,b,6,w),o.strokeStyle="#654321",o.lineWidth=2,o.strokeRect(g,b-3,v,6),o.strokeRect(g+v-3,b,6,w),e.water_flow.isActive){o.fillStyle="#4A90E2";for(let t=0;t<4;t++){const e=(60*a+25*t)%(v+w+50);let l,s;e<v?(l=g+e,s=b):e<v+w?(l=g+v,s=b+(e-v)):(l=g+v,s=h-30+(e-v-w)),o.beginPath(),o.arc(l,s,4,0,2*Math.PI),o.fill(),o.fillStyle="#87CEEB",o.beginPath(),o.arc(l+1,s+1,3,0,2*Math.PI),o.fill(),o.fillStyle="#4A90E2"}const e=v/3;for(let t=1;t<3;t++){const l=g+e*t;30*a%30<15&&(o.fillStyle="#FF6B35",o.beginPath(),o.moveTo(l,b),o.lineTo(l-4,b-8),o.lineTo(l+4,b-8),o.closePath(),o.fill())}}o.strokeStyle="#FF6B35",o.lineWidth=2,o.beginPath(),o.moveTo(g,b-15),o.lineTo(g+v,b-15),o.stroke(),o.beginPath(),o.moveTo(g+5,b-10),o.lineTo(g,b-15),o.lineTo(g+5,b-20),o.stroke(),o.beginPath(),o.moveTo(g+v-5,b-10),o.lineTo(g+v,b-15),o.lineTo(g+v-5,b-20),o.stroke(),o.fillStyle="#FF6B35",o.font="bold 10px Arial",o.fillText(`${(v/x).toFixed(1)}m`,g+v/2-15,b-25);let S=h-50;(r.length>0?r:e.soil_layers).forEach((e,l)=>{const a=e.thickness_m*x,s=(r.length,e.color);o.fillStyle=s,o.fillRect(0,S,t.offsetWidth,a),o.strokeStyle=s,o.lineWidth=1;for(let i=0;i<a;i+=4)o.beginPath(),o.moveTo(0,S+i),o.lineTo(t.offsetWidth,S+i),o.stroke();if(o.fillStyle="#000",o.font="bold 12px Arial",o.fillText(e.name,10,S+15),o.font="10px Arial",o.fillStyle="#333",o.fillText(`${e.thickness_m.toFixed(1)}m thick`,10,S+30),r.length>0){const t=e;o.fillText(`Permeability: ${(1e6*t.permeability).toFixed(2)} μm/s`,10,S+45),o.fillText(`Porosity: ${(100*t.porosity).toFixed(1)}%`,10,S+60),o.fillText(`pH: ${t.ph.toFixed(1)}`,10,S+75)}o.strokeStyle="#666",o.lineWidth=2,o.setLineDash([5,5]),o.beginPath(),o.moveTo(t.offsetWidth-100,S),o.lineTo(t.offsetWidth-20,S),o.stroke(),o.setLineDash([]),o.fillStyle="#666",o.font="10px Arial",o.fillText(`${S.toFixed(0)}m`,t.offsetWidth-95,S-5),S+=a});const N=h-50+e.groundwater_depth_m*x;o.fillStyle="#4A90E2",o.globalAlpha=.8;const k=3*Math.sin(.5*a),T=2*Math.sin(.8*a);o.beginPath(),o.moveTo(0,N+k);for(let e=0;e<t.offsetWidth;e+=5){const t=N+4*Math.sin(.02*(e+30*a))+2*Math.sin(.01*(e+60*a))+k+T;o.lineTo(e,t)}o.lineTo(t.offsetWidth,N+k),o.lineTo(t.offsetWidth,t.offsetHeight),o.lineTo(0,t.offsetHeight),o.closePath(),o.fill(),o.fillStyle="#87CEEB",o.globalAlpha=.3,o.beginPath(),o.moveTo(0,N+k-2);for(let e=0;e<t.offsetWidth;e+=5){const t=N+4*Math.sin(.02*(e+30*a))+2*Math.sin(.01*(e+60*a))+k+T-2;o.lineTo(e,t)}o.lineTo(t.offsetWidth,N+k-2),o.lineTo(t.offsetWidth,N+k),o.lineTo(0,N+k),o.closePath(),o.fill(),o.globalAlpha=1,o.strokeStyle="#0066CC",o.lineWidth=3,o.setLineDash([10,5]),o.beginPath(),o.moveTo(50,N+k),o.lineTo(t.offsetWidth-50,N+k),o.stroke(),o.setLineDash([]),o.fillStyle="#0066CC",o.font="bold 12px Arial",o.fillText(`Water Table: ${e.groundwater_depth_m.toFixed(1)}m`,60,N+k-10);const P=e.shaft.depth_m*x,M=o.createLinearGradient(y-j/2,h-50,y+j/2,h-50);if(M.addColorStop(0,"#8B4513"),M.addColorStop(.5,"#654321"),M.addColorStop(1,"#8B4513"),o.fillStyle=M,o.fillRect(y-j/2,h-50,j,P),o.strokeStyle="#4A2C1F",o.lineWidth=3,o.strokeRect(y-j/2,h-50,j,P),l>0){const e=l+.5*Math.sin(.5*a),t=Math.max(0,e*x),s=.8*P,i=Math.min(t,s),r=o.createLinearGradient(y-j/2,h-50+P-i,y+j/2,h-50+P);r.addColorStop(0,"#87CEEB"),r.addColorStop(.5,"#4A90E2"),r.addColorStop(1,"#87CEEB"),o.fillStyle=r,o.fillRect(y-j/2+3,h-50+P-i,j-6,i),o.fillStyle="#B0E0E6",o.globalAlpha=.8;const n=h-50+P-i,d=2*Math.sin(3*a);o.fillRect(y-j/2+3,n+d,j-6,3),o.globalAlpha=1,o.fillStyle="#0066CC",o.font="bold 10px Arial",o.fillText(`Water: ${e.toFixed(1)}m`,y-20,n-5)}o.fillStyle="#000",o.font="bold 12px Arial",o.fillText("Storage Shaft",y-30,h-60),o.strokeStyle="#FF6B35",o.lineWidth=2,o.beginPath(),o.moveTo(y+j/2+20,h-50),o.lineTo(y+j/2+20,h-50+P),o.stroke(),o.beginPath(),o.moveTo(y+j/2+15,h-50+5),o.lineTo(y+j/2+20,h-50),o.lineTo(y+j/2+25,h-50+5),o.stroke(),o.beginPath(),o.moveTo(y+j/2+15,h-50+P-5),o.lineTo(y+j/2+20,h-50+P),o.lineTo(y+j/2+25,h-50+P-5),o.stroke(),o.fillStyle="#FF6B35",o.font="bold 10px Arial",o.fillText(`${e.shaft.depth_m.toFixed(1)}m`,y+j/2+30,h-50+P/2),o.strokeStyle="#FF6B35",o.lineWidth=2,o.beginPath(),o.moveTo(y-j/2,h-50-20),o.lineTo(y+j/2,h-50-20),o.stroke(),o.beginPath(),o.moveTo(y-j/2+5,h-50-15),o.lineTo(y-j/2,h-50-20),o.lineTo(y-j/2+5,h-50-25),o.stroke(),o.beginPath(),o.moveTo(y+j/2-5,h-50-15),o.lineTo(y+j/2,h-50-20),o.lineTo(y+j/2-5,h-50-25),o.stroke(),o.fillStyle="#FF6B35",o.font="bold 10px Arial",o.fillText(`${(j/x).toFixed(1)}m`,y,h-50-30);const F=m+100,C=.3*x,A=e.borewell.depth_m*x,L=o.createLinearGradient(F-C/2,h-50,F+C/2,h-50);if(L.addColorStop(0,"#A0522D"),L.addColorStop(.5,"#8B4513"),L.addColorStop(1,"#A0522D"),o.fillStyle=L,o.fillRect(F-C/2,h-50,C,A),o.strokeStyle="#654321",o.lineWidth=2,o.strokeRect(F-C/2,h-50,C,A),l>0){const e=l+.3*Math.sin(.3*a+Math.PI),t=Math.max(0,e*x),s=.6*A,i=Math.min(t,s),r=o.createLinearGradient(F-C/2,h-50+A-i,F+C/2,h-50+A);r.addColorStop(0,"#87CEEB"),r.addColorStop(.5,"#4A90E2"),r.addColorStop(1,"#87CEEB"),o.fillStyle=r,o.fillRect(F-C/2+2,h-50+A-i,C-4,i),o.fillStyle="#B0E0E6",o.globalAlpha=.8;const n=h-50+A-i,d=1.5*Math.sin(2.5*a);o.fillRect(F-C/2+2,n+d,C-4,2),o.globalAlpha=1,o.fillStyle="#0066CC",o.font="bold 10px Arial",o.fillText(`Water: ${e.toFixed(1)}m`,F-20,n-5)}o.fillStyle="#000",o.font="bold 12px Arial",o.fillText("Recharge Borewell",F-40,h-60),o.strokeStyle="#FF6B35",o.lineWidth=2,o.beginPath(),o.moveTo(F-C/2-20,h-50),o.lineTo(F-C/2-20,h-50+A),o.stroke(),o.beginPath(),o.moveTo(F-C/2-15,h-50+5),o.lineTo(F-C/2-20,h-50),o.lineTo(F-C/2-25,h-50+5),o.stroke(),o.beginPath(),o.moveTo(F-C/2-15,h-50+A-5),o.lineTo(F-C/2-20,h-50+A),o.lineTo(F-C/2-25,h-50+A-5),o.stroke(),o.fillStyle="#FF6B35",o.font="bold 10px Arial",o.fillText(`${e.borewell.depth_m.toFixed(1)}m`,F-C/2-30,h-50+A/2),o.strokeStyle="#FF6B35",o.lineWidth=2,o.beginPath(),o.moveTo(F-C/2,h-50-20),o.lineTo(F+C/2,h-50-20),o.stroke(),o.beginPath(),o.moveTo(F-C/2+5,h-50-15),o.lineTo(F-C/2,h-50-20),o.lineTo(F-C/2+5,h-50-25),o.stroke(),o.beginPath(),o.moveTo(F+C/2-5,h-50-15),o.lineTo(F+C/2,h-50-20),o.lineTo(F+C/2-5,h-50-25),o.stroke(),o.fillStyle="#FF6B35",o.font="bold 10px Arial",o.fillText("0.3m (Standard)",F-15,h-50-30);const D=o.createLinearGradient(y+j/2,h-30,F-C/2,h-30);D.addColorStop(0,"#8B4513"),D.addColorStop(.5,"#A0522D"),D.addColorStop(1,"#8B4513"),o.fillStyle=D,o.fillRect(y+j/2,h-32,F-C/2-(y+j/2),4),o.strokeStyle="#654321",o.lineWidth=2,o.strokeRect(y+j/2,h-32,F-C/2-(y+j/2),4);const B=.8*P,E=l>B;if(E){o.fillStyle="#87CEEB";const e=Math.abs(F-C/2-(y+j/2));for(let l=0;l<4;l++){const t=y+j/2+(50*a+25*l)%e;o.beginPath(),o.arc(t,h-30,4,0,2*Math.PI),o.fill(),o.fillStyle="#B0E0E6",o.beginPath(),o.arc(t+1,h-30+1,3,0,2*Math.PI),o.fill(),o.fillStyle="#87CEEB"}const t=e/5;for(let l=1;l<5;l++){const e=y+j/2+t*l;25*a%25<12&&(o.fillStyle="#FF6B35",o.beginPath(),o.moveTo(e,h-30),o.lineTo(e-6,h-38),o.lineTo(e+6,h-38),o.closePath(),o.fill())}o.fillStyle="#FF6B35",o.font="bold 11px Arial";const s=(.8*(l-B)).toFixed(1);o.fillText(`Overflow: ${s} L/min`,y+j/2+60,h-45)}if(E){o.fillStyle="#87CEEB",o.globalAlpha=.6;const e=.8*j;o.beginPath(),o.arc(y,h-50,e,0,2*Math.PI),o.fill();const t=.2*Math.sin(4*a)+.8;o.globalAlpha=.4*t,o.beginPath(),o.arc(y,h-50,1.2*e,0,2*Math.PI),o.fill(),o.globalAlpha=1}if(o.fillStyle="#000",o.font="bold 14px Arial",o.fillText("Rooftop Collection",f-20,h-60-u),o.font="10px Arial",o.fillStyle="#333",o.fillText(`${e.rooftop.width_m.toFixed(1)}m × ${e.rooftop.height_m.toFixed(1)}m`,f-15,h-45-u),o.fillStyle="#000",o.font="bold 12px Arial",o.fillText("Storage Shaft",y-25,h-60),o.fillText("Recharge Borewell",F-35,h-60),o.fillText("Groundwater Aquifer",m-40,h+100),o.font="bold 11px Arial",o.fillStyle="#0066CC",o.fillText("Rainwater Collection",g+v/2-30,b-15),E&&(o.fillStyle="#FF6B35",o.fillText("Overflow to Borewell",y+j/2+30,h-45)),o.fillStyle="#666",o.font="10px Arial",o.fillText(`Data Source: ${n}`,10,t.offsetHeight-20),d){o.fillStyle="#FF6B35",o.font="bold 12px Arial",o.fillText("Loading real-time data...",10,t.offsetHeight-40);const e=Math.floor(2*a)%4;for(let l=0;l<3;l++)o.fillStyle=l===e?"#FF6B35":"#999",o.beginPath(),o.arc(200+10*l,t.offsetHeight-35,2,0,2*Math.PI),o.fill()}s&&requestAnimationFrame(i)};i()},[e,l,a,s]);return m.jsxs("div",{className:"w-full h-full relative bg-gradient-to-b from-blue-100 to-green-100",children:[m.jsx("canvas",{ref:h,className:"w-full h-full cursor-pointer",onClick:l=>{var a,s,o;const i=h.current;if(!i)return;const r=i.getBoundingClientRect(),n=l.clientX-r.left,d=l.clientY-r.top,c=i.offsetWidth/2,m=i.offsetHeight/2,x=Math.min(i.offsetWidth,i.offsetHeight)/20,p=c-100,u=2.5*(e.shaft.diameter_m*x),g=e.shaft.depth_m*x;if(n>=p-u/2&&n<=p+u/2&&d>=m-50&&d<=m-50+g)return f("shaft"),void(null==(a=t.onSelection)||a.call(t,"shaft"));const b=c+100,y=.3*x,j=e.borewell.depth_m*x;if(n>=b-y/2&&n<=b+y/2&&d>=m-50&&d<=m-50+j)return f("borewell"),void(null==(s=t.onSelection)||s.call(t,"borewell"));f(null),null==(o=t.onSelection)||o.call(t,null)},style:{imageRendering:"pixelated"}}),m.jsx("div",{className:"absolute top-4 left-4 bg-black/80 text-white p-4 rounded-lg backdrop-blur-sm min-w-[280px]",children:m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("button",{onClick:i,className:"px-3 py-1 bg-blue-600 rounded hover:bg-blue-700 transition-colors",children:s?"⏸️":"▶️"}),m.jsx("span",{className:"text-sm font-medium",children:"Animation Control"})]}),m.jsxs("div",{className:"border-t border-gray-600 pt-3",children:[m.jsxs("label",{className:"text-sm block mb-1 font-medium",children:["Water Level: ",l.toFixed(1),"m"]}),m.jsx("input",{type:"range",min:e.groundwater_depth_m-5,max:e.groundwater_depth_m+5,value:l,onChange:e=>o(parseFloat(e.target.value)),className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer"}),m.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[m.jsxs("span",{children:[(e.groundwater_depth_m-5).toFixed(1),"m"]}),m.jsxs("span",{children:[(e.groundwater_depth_m+5).toFixed(1),"m"]})]})]}),m.jsxs("div",{className:"border-t border-gray-600 pt-3",children:[m.jsx("label",{className:"text-sm block mb-1 font-medium",children:"System Components"}),m.jsxs("div",{className:"space-y-2 text-xs",children:[m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{children:"Rooftop Area:"}),m.jsxs("span",{className:"text-blue-300",children:[(e.rooftop.width_m*e.rooftop.height_m).toFixed(1),"m²"]})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{children:"Shaft Volume:"}),m.jsxs("span",{className:"text-green-300",children:[(Math.PI*Math.pow(e.shaft.diameter_m/2,2)*e.shaft.depth_m).toFixed(1),"m³"]})]}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{children:"Borewell Depth:"}),m.jsxs("span",{className:"text-orange-300",children:[e.borewell.depth_m.toFixed(1),"m"]})]})]})]}),m.jsxs("div",{className:"border-t border-gray-600 pt-3",children:[m.jsx("label",{className:"text-sm block mb-1 font-medium",children:"Data Source"}),m.jsx("div",{className:"text-xs text-gray-300",children:d?m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-400"}),m.jsx("span",{children:"Loading..."})]}):m.jsx("span",{className:"text-green-400",children:n})})]}),r.length>0&&m.jsxs("div",{className:"border-t border-gray-600 pt-3",children:[m.jsx("label",{className:"text-sm block mb-1 font-medium",children:"Soil Information"}),m.jsx("div",{className:"space-y-1 text-xs",children:r.map((e,t)=>m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:"w-3 h-3 rounded-full border border-white",style:{backgroundColor:e.color}}),m.jsx("span",{className:"text-gray-300",children:e.name}),m.jsxs("span",{className:"text-gray-400",children:["(",e.thickness_m.toFixed(1),"m)"]})]},t))})]})]})}),x&&m.jsxs("div",{className:"absolute bottom-4 left-4 bg-black/70 text-white p-4 rounded-lg backdrop-blur-sm",children:[m.jsxs("h3",{className:"font-bold mb-2",children:["Selected: ",x]}),"borewell"===x&&m.jsxs("div",{children:[m.jsxs("div",{children:["Depth: ",e.borewell.depth_m,"m"]}),m.jsxs("div",{children:["Diameter: ",e.borewell.diameter_m,"m"]}),m.jsxs("div",{children:["Water Level: ",l.toFixed(1),"m"]})]}),"shaft"===x&&m.jsxs("div",{children:[m.jsxs("div",{children:["Depth: ",e.shaft.depth_m,"m"]}),m.jsxs("div",{children:["Diameter: ",e.shaft.diameter_m,"m"]}),m.jsxs("div",{children:["Size: ",e.shaft.size_category]}),m.jsxs("div",{children:["Overflow: ",l>e.shaft.depth_m?"Yes":"No"]})]})]}),m.jsx("div",{className:"absolute top-4 right-4 bg-yellow-600 text-white px-3 py-1 rounded text-sm",children:"2D Fallback Mode"})]})},I={small_shaft:{soil_layers:[{name:"Topsoil",thickness_m:2,permeability:.8,porosity:.4,color:"#8B4513"},{name:"Sand",thickness_m:8,permeability:.9,porosity:.35,color:"#F4A460"},{name:"Clay",thickness_m:5,permeability:.1,porosity:.5,color:"#CD853F"},{name:"Gravel",thickness_m:10,permeability:.95,porosity:.25,color:"#A9A9A9"},{name:"Bedrock",thickness_m:15,permeability:.05,porosity:.1,color:"#696969"}],groundwater_depth_m:12,borewell:{depth_m:25,diameter_m:.3,position:[0,0,0]},shaft:{depth_m:8,diameter_m:.2,size_category:"small"},rooftop:{width_m:8,length_m:6,height_m:3,position:[-4,0,1.5],pipe_diameter_m:.15,pipe_length_m:6},overflow_threshold:8,water_flow:{isActive:!0,flowRate:1,direction:"down",color:"#4A90E2"}},medium_shaft:{soil_layers:[{name:"Topsoil",thickness_m:1.5,permeability:.7,porosity:.45,color:"#8B4513"},{name:"Sand",thickness_m:12,permeability:.85,porosity:.3,color:"#F4A460"},{name:"Clay",thickness_m:8,permeability:.15,porosity:.55,color:"#CD853F"},{name:"Gravel",thickness_m:15,permeability:.9,porosity:.2,color:"#A9A9A9"},{name:"Bedrock",thickness_m:20,permeability:.08,porosity:.12,color:"#696969"}],groundwater_depth_m:15,borewell:{depth_m:30,diameter_m:.4,position:[0,0,0]},shaft:{depth_m:12,diameter_m:.3,size_category:"medium"},rooftop:{width_m:10,length_m:8,height_m:3.5,position:[-5,0,1.75],pipe_diameter_m:.2,pipe_length_m:7},overflow_threshold:12,water_flow:{isActive:!0,flowRate:1.2,direction:"down",color:"#4A90E2"}},large_shaft:{soil_layers:[{name:"Topsoil",thickness_m:3,permeability:.6,porosity:.5,color:"#8B4513"},{name:"Sand",thickness_m:15,permeability:.8,porosity:.28,color:"#F4A460"},{name:"Clay",thickness_m:10,permeability:.2,porosity:.6,color:"#CD853F"},{name:"Gravel",thickness_m:20,permeability:.85,porosity:.18,color:"#A9A9A9"},{name:"Bedrock",thickness_m:25,permeability:.1,porosity:.15,color:"#696969"}],groundwater_depth_m:18,borewell:{depth_m:35,diameter_m:.5,position:[0,0,0]},shaft:{depth_m:15,diameter_m:.4,size_category:"large"},rooftop:{width_m:12,length_m:10,height_m:4,position:[-6,0,2],pipe_diameter_m:.25,pipe_length_m:8},overflow_threshold:15,water_flow:{isActive:!0,flowRate:1.5,direction:"down",color:"#4A90E2"}}},O=(e,t)=>d(void 0,null,function*(){try{const l=`/api/aquifer-depth?lat=${e}&lon=${t}`,a=yield fetch(l);if(!a.ok)throw new Error("Failed to fetch aquifer depth");return(yield a.json()).depth_m||12}catch(l){return 12}});function $(){const{t:e}=h(),[t,l]=(x(),c.useState(null)),[a,s]=c.useState(22.5),[o,i]=c.useState(77),[g,b]=c.useState(null),[y,j]=c.useState(null),[v,_]=c.useState(I.small_shaft),[w,S]=c.useState({enablePerformanceMode:!1,maxPolygons:1e4,textureSize:512,enableLOD:!0,enableWaterShader:!0}),[N,P]=c.useState(!1),[M,F]=c.useState(12),[C,A]=c.useState(0),[L,D]=c.useState(!0),[B,E]=c.useState(null),[$,G]=c.useState(!1),[H,z]=c.useState("Loading..."),[q,U]=c.useState([]);c.useEffect(()=>{j(null),l(null);(()=>{d(this,null,function*(){try{G(!0);const e=yield k.fetchGroundwaterData(a,o);if(!e.success||!e.data)throw new Error(e.error||"Failed to fetch groundwater data");{const s=e.data,i={location:{name:s.location.name,lat:s.location.lat,lon:s.location.lon},timestamp:s.groundwater.last_updated,data_source:s.metadata.data_source,aquifers:[{id:`${a},${o}`,name:`${s.aquifer.type} Aquifer`,depth_from:0,depth_to:s.aquifer.thickness_m,water_table:s.groundwater.level_m,color:(t=s.groundwater.level_m,t<10?"#34d399":t<30?"#fbbf24":t<60?"#fb7185":"#6366f1"),aquifer_type:s.aquifer.type,borewells_connected:1}]};l(i);const d=[{name:s.soil.type,thickness_m:s.soil.depth_m,permeability:s.soil.permeability,porosity:s.aquifer.porosity,color:s.soil.color,texture:s.soil.texture,water_holding_capacity:s.soil.water_holding_capacity,organic_matter:2.5,ph:6.8,nutrients:{nitrogen:"Medium",phosphorus:"Low",potassium:"High"}}];U(d),_(e=>n(r({},e),{groundwater_depth_m:s.groundwater.level_m,soil_layers:[{name:s.soil.type,thickness_m:s.soil.depth_m,permeability:s.soil.permeability,porosity:s.aquifer.porosity,color:s.soil.color}]})),F(s.groundwater.level_m),z(`${e.source} (${(100*s.metadata.confidence).toFixed(0)}% confidence)`)}}catch(s){j("Using demo data - real data unavailable"),((e,t)=>d(void 0,null,function*(){const l=`/api/gamification/groundwater?lat=${e}&lon=${t}`;let a=yield fetch(l);if(404!==a.status&&405!==a.status||(a=yield fetch(`/groundwater?lat=${e}&lon=${t}`)),!a.ok)throw new Error("Failed to fetch groundwater data");const s=yield a.json();return{location:{name:s.location,lat:e,lon:t},timestamp:s.last_updated,data_source:"RTRWH Backend",aquifers:[{id:`${e},${t}`,name:s.location,depth_from:0,depth_to:80,water_table:s.groundwater_level_m,color:"#60a5fa",aquifer_type:s.aquifer_type,borewells_connected:s.borewells_connected}]}}))(a,o).then(l).catch(t=>j(t.message||e("vad.error_fetch"))),O(a,o).then(e=>{_(t=>n(r({},t),{groundwater_depth_m:e})),F(e)}),z("Demo Data (Real API Unavailable)")}finally{G(!1)}var t})})()},[a,o,e]),c.useEffect(()=>{const e=setInterval(()=>{O(a,o).then(e=>{_(t=>n(r({},t),{groundwater_depth_m:e}))})},3e4);return()=>clearInterval(e)},[a,o]),c.useEffect(()=>{if(!L)return;const e=setInterval(()=>{A(e=>e+.1);const e=C%10/10,t=v.groundwater_depth_m+2*Math.sin(e*Math.PI*2);F(t)},100);return()=>clearInterval(e)},[L,C,v.groundwater_depth_m]),c.useEffect(()=>{const e=document.createElement("canvas"),t=e.getContext("webgl")||e.getContext("experimental-webgl"),l=navigator.hardwareConcurrency&&navigator.hardwareConcurrency<4;t&&!l||(P(!0),S(e=>n(r({},e),{enablePerformanceMode:!0})))},[]);const Y=c.useMemo(()=>({onLevelChange:e=>{F(e)},onOverflow:e=>{},onSelection:e=>{E(e)}}),[]),K=e=>{const t=`${e}_shaft`;_(I[t]),F(I[t].groundwater_depth_m)},X=e=>{S(t=>n(r({},t),{enablePerformanceMode:e}))};c.useEffect(()=>{const e=e=>{if(!(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement))switch(e.code){case"Space":e.preventDefault(),D(!L);break;case"ArrowUp":e.preventDefault(),F(e=>Math.min(e+.5,v.groundwater_depth_m+5));break;case"ArrowDown":e.preventDefault(),F(e=>Math.max(e-.5,v.groundwater_depth_m-5));break;case"Digit1":e.preventDefault(),K("small");break;case"Digit2":e.preventDefault(),K("medium");break;case"Digit3":e.preventDefault(),K("large");break;case"KeyP":e.preventDefault(),X(!w.enablePerformanceMode);break;case"KeyF":e.preventDefault(),P(!N)}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[L,v.groundwater_depth_m,w.enablePerformanceMode,N]);const J=c.useMemo(()=>(null==t?void 0:t.aquifers)||[],[t]);c.useMemo(()=>Math.max(...J.map(e=>e.depth_to),1),[J]);const V=()=>{if(!t)return;const e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),l=URL.createObjectURL(e),a=document.createElement("a");a.href=l,a.download=`aquifer_data_${t.location.name.replace(/\s+/g,"_")}.json`,a.click(),URL.revokeObjectURL(l)};return e("voice_commands.set_latitude"),e("voice_commands.set_longitude"),e("voice_commands.download_data"),e("voice_commands.go_home"),m.jsxs(T.div,{className:"mx-auto my-8 p-6 rounded-3xl shadow-2xl border bg-white/80 backdrop-blur-lg","aria-label":e("aria.vad_main"),initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[m.jsxs("header",{className:"mb-4 flex justify-between items-center",children:[m.jsxs("div",{children:[m.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"Rooftop Rainwater Collection System"}),m.jsx("p",{className:"text-gray-600 mt-1",children:"Interactive 3D visualization of rainwater flow from rooftop to aquifer recharge"})]}),m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx(f,{to:"/dashboard",className:"text-blue-600 hover:underline",children:e("gda.back_to_dashboard")}),m.jsx("button",{onClick:()=>P(!N),className:"px-3 py-1 bg-gray-600 text-white rounded hover:bg-gray-700 text-sm",title:"Toggle 2D/3D mode",children:N?"3D":"2D"})]})]}),m.jsxs("div",{className:"mb-6 bg-gradient-to-r from-blue-50 to-green-50 rounded-2xl p-6 border border-blue-200",children:[m.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Water Flow System"}),m.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-4 text-sm",children:[m.jsxs("div",{className:"flex items-center gap-2 bg-white px-3 py-2 rounded-lg shadow-sm",children:[m.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),m.jsx("span",{className:"font-medium",children:"Rooftop"})]}),m.jsx("div",{className:"text-gray-400",children:"↓"}),m.jsxs("div",{className:"flex items-center gap-2 bg-white px-3 py-2 rounded-lg shadow-sm",children:[m.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full"}),m.jsx("span",{className:"font-medium",children:"Pipe"})]}),m.jsx("div",{className:"text-gray-400",children:"→"}),m.jsxs("div",{className:"flex items-center gap-2 bg-white px-3 py-2 rounded-lg shadow-sm",children:[m.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),m.jsx("span",{className:"font-medium",children:"Pit/Trench/Shaft"})]}),m.jsx("div",{className:"text-gray-400",children:"→"}),m.jsxs("div",{className:"flex items-center gap-2 bg-white px-3 py-2 rounded-lg shadow-sm",children:[m.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full"}),m.jsx("span",{className:"font-medium",children:"Borewell"})]}),m.jsx("div",{className:"text-gray-400",children:"↓"}),m.jsxs("div",{className:"flex items-center gap-2 bg-white px-3 py-2 rounded-lg shadow-sm",children:[m.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),m.jsx("span",{className:"font-medium",children:"Aquifer"})]})]})]}),m.jsxs("div",{className:"mb-4 p-4 bg-gradient-to-r from-blue-50 to-green-50 rounded-lg border border-blue-200",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),m.jsxs("div",{children:[m.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Data Source:"}),m.jsx("span",{className:"text-sm text-blue-600 ml-2",children:H})]})]}),$&&m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),m.jsx("span",{className:"text-sm text-blue-600",children:"Loading real data..."})]})]}),q.length>0&&m.jsx("div",{className:"mt-3 pt-3 border-t border-blue-200",children:m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsx("span",{className:"text-sm font-medium text-green-800",children:"Soil Type:"}),q.map((e,t)=>m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white shadow-sm",style:{backgroundColor:e.color}}),m.jsx("span",{className:"text-sm text-green-600",children:e.name}),m.jsxs("span",{className:"text-xs text-gray-500",children:["(",e.texture,")"]})]},t))]})})]}),m.jsxs("div",{className:"mb-6 h-96 rounded-2xl overflow-hidden shadow-lg border relative",children:[$&&m.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm flex items-center justify-center z-10",children:m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),m.jsx("p",{className:"text-blue-600 font-medium",children:"Loading groundwater data from Indian APIs..."}),m.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Trying India WRIS, CGWB, and other sources"})]})}),N?m.jsx(R,{config:v,callbacks:Y,waterLevel:M,animationTime:C,isPlaying:L,onLevelChange:F,onTogglePlay:()=>D(!L),enhancedSoilLayers:q,dataSource:H,isLoading:$}):m.jsx(W,{config:v,callbacks:Y,performanceSettings:w})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[m.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 shadow-inner border",children:[m.jsxs("h3",{className:"font-semibold text-gray-700 mb-3 flex items-center gap-2",children:[m.jsx(p,{className:"text-blue-600"}),"Shaft Configuration"]}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-sm text-gray-600 block mb-1",children:"Shaft Size"}),m.jsxs("select",{value:v.shaft.size_category,onChange:e=>K(e.target.value),className:"w-full bg-white border rounded px-3 py-2",children:[m.jsx("option",{value:"small",children:"Small (Pit overflow)"}),m.jsx("option",{value:"medium",children:"Medium (Pit + Channel)"}),m.jsx("option",{value:"large",children:"Large (Trench overflow)"})]})]}),m.jsxs("div",{children:[m.jsxs("label",{className:"text-sm text-gray-600 block mb-1",children:["Depth: ",v.shaft.depth_m,"m"]}),m.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:m.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:v.shaft.depth_m/20*100+"%"}})})]}),m.jsxs("div",{children:[m.jsxs("label",{className:"text-sm text-gray-600 block mb-1",children:["Diameter: ",v.shaft.diameter_m,"m"]}),m.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:m.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:v.shaft.diameter_m/.5*100+"%"}})})]})]})]}),m.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 shadow-inner border",children:[m.jsxs("h3",{className:"font-semibold text-gray-700 mb-3 flex items-center gap-2",children:[m.jsx(u,{className:"text-green-600"}),"Performance"]}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-sm text-gray-600",children:"Performance Mode"}),m.jsx("input",{type:"checkbox",checked:w.enablePerformanceMode,onChange:e=>X(e.target.checked),className:"rounded"})]}),m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-sm text-gray-600",children:"Water Shader"}),m.jsx("input",{type:"checkbox",checked:w.enableWaterShader,onChange:e=>S(t=>n(r({},t),{enableWaterShader:e.target.checked})),className:"rounded"})]}),m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-sm text-gray-600",children:"LOD System"}),m.jsx("input",{type:"checkbox",checked:w.enableLOD,onChange:e=>S(t=>n(r({},t),{enableLOD:e.target.checked})),className:"rounded"})]}),m.jsxs("div",{className:"text-xs text-gray-500",children:["Max Polygons: ",w.maxPolygons.toLocaleString()]})]})]}),m.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 shadow-inner border",children:[m.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"System Status"}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{children:"Mode:"}),m.jsx("span",{className:N?"text-yellow-600":"text-green-600",children:N?"2D Fallback":"3D WebGL"})]}),m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{children:"Water Level:"}),m.jsxs("span",{className:"text-blue-600",children:[M.toFixed(1),"m"]})]}),m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{children:"Animation:"}),m.jsx("span",{className:L?"text-green-600":"text-red-600",children:L?"Playing":"Paused"})]}),m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{children:"Selected:"}),m.jsx("span",{className:"text-purple-600",children:B||"None"})]})]})]})]}),t&&m.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 shadow-inner border",children:[m.jsx("h3",{className:"font-semibold text-gray-700 mb-3",children:"Location Data"}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[m.jsxs("div",{children:[m.jsx("h4",{className:"font-medium text-gray-600",children:"Location"}),m.jsx("p",{children:t.location.name}),m.jsxs("p",{className:"text-sm text-gray-500",children:["(",t.location.lat,", ",t.location.lon,")"]})]}),m.jsxs("div",{children:[m.jsx("h4",{className:"font-medium text-gray-600",children:"Data Source"}),m.jsx("p",{children:t.data_source}),m.jsxs("p",{className:"text-sm text-gray-500",children:["Last updated: ",new Date(t.timestamp).toLocaleString()]})]})]}),m.jsx("button",{onClick:V,className:"btn btn-sm btn-outline mt-4","aria-label":e("aria.download_data"),children:"Download Data"})]}),m.jsxs("div",{className:"mt-6 bg-blue-50 rounded-2xl p-4 border border-blue-200",children:[m.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:"Keyboard Shortcuts"}),m.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-2 text-sm text-blue-700",children:[m.jsxs("div",{children:[m.jsx("kbd",{className:"bg-blue-200 px-2 py-1 rounded",children:"Space"})," Toggle animation"]}),m.jsxs("div",{children:[m.jsx("kbd",{className:"bg-blue-200 px-2 py-1 rounded",children:"↑/↓"})," Adjust water level"]}),m.jsxs("div",{children:[m.jsx("kbd",{className:"bg-blue-200 px-2 py-1 rounded",children:"1/2/3"})," Shaft size"]}),m.jsxs("div",{children:[m.jsx("kbd",{className:"bg-blue-200 px-2 py-1 rounded",children:"P"})," Performance mode"]}),m.jsxs("div",{children:[m.jsx("kbd",{className:"bg-blue-200 px-2 py-1 rounded",children:"F"})," Toggle 2D/3D"]})]})]})]})}export{$ as default};
