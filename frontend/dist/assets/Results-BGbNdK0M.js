import{u as e,e as s,C as t,r,j as a,L as l}from"./react-vendor-BIG0dXTf.js";import{a as n}from"./api-CUAgWf1P.js";import i from"./VisualAquiferDepthDisplay-CDzzBPLo.js";import{u as o,a as d,L as c}from"./index-DdHcYEUd.js";import{u as m,V as u}from"./VoiceAssistantUI-DgXj8NA7.js";import{R as x,L as h,C as g,X as j,Y as p,T as b,a as f,b as v}from"./LineChart-CdOcRGC2.js";import"./vendor-B0m_Fmqf.js";/* empty css                */import"./framer-motion-CjfoqxEY.js";function N(){const{t:N}=e(),y=s(),{isAuthenticated:_,isLoading:w}=o(),{isDark:k}=d(),{id:L}=t(),[C,M]=r.useState(null),[A,R]=r.useState(null),[B,S]=r.useState(!1),[D,V]=r.useState(!1);if(r.useEffect(()=>{w||_||y("/auth?mode=login")},[_,w,y]),w)return a.jsx("div",{className:"min-h-screen flex items-center justify-center "+(k?"bg-slate-900":"bg-gradient-to-br from-slate-50 via-blue-50 to-cyan-50"),children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-lg font-medium "+(k?"text-slate-300":"text-slate-600"),children:"Checking authentication..."})]})});if(!_)return null;function z(e){return s=this,t=null,r=function*(){var s,t;if(!L)return;const r="ai"===e;r?S(!0):V(!0);try{const s=yield n.get(`/reports/${L}/${e}.pdf`,{responseType:"blob"}),t=new Blob([s.data],{type:"application/pdf"}),r=window.URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.download=`assessment_${L}_${e}.pdf`,document.body.appendChild(a),a.click(),a.remove(),window.URL.revokeObjectURL(r)}catch(a){alert((null==(t=null==(s=a.response)?void 0:s.data)?void 0:t.detail)||N(r?"results.error_download_ai":"results.error_download_guide"))}finally{r?S(!1):V(!1)}},new Promise((e,a)=>{var l=e=>{try{i(r.next(e))}catch(s){a(s)}},n=e=>{try{i(r.throw(e))}catch(s){a(s)}},i=s=>s.done?e(s.value):Promise.resolve(s.value).then(l,n);i((r=r.apply(s,t)).next())});var s,t,r}r.useEffect(()=>{L&&n.get(`/assessments/${L}`).then(e=>M(e.data)).catch(e=>{var s,t;return R((null==(t=null==(s=e.response)?void 0:s.data)?void 0:t.detail)||N("results.error_load"))})},[L,N]);const U={[N("voice_commands.download_pdf")]:()=>z("ai"),[N("voice_commands.download_guide")]:()=>z("guide"),[N("voice_commands.new_assessment")]:()=>y("/assess")},{isListening:W,setIsListening:I,feedback:O}=m(U);if(A)return a.jsx("div",{className:"p-6 max-w-5xl mx-auto text-red-600",children:A});if(!C)return a.jsx("div",{className:"p-6 max-w-5xl mx-auto",children:N("results.loading")});const $=[{name:N("results.chart_runoff"),liters:Math.round(C.results.runoff.annual_runoff_volume_liters)},{name:N("results.chart_storage"),liters:Math.round(C.results.structure.storage_volume_liters)}];return a.jsxs("div",{className:"min-h-screen pt-24 pb-10 "+(k?"bg-slate-900":"bg-gradient-to-br from-blue-50 via-white to-cyan-50"),children:[a.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[a.jsxs("header",{className:"flex items-center justify-between mb-8",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent mb-2",children:N("results.title")}),a.jsxs("p",{className:""+(k?"text-slate-400":"text-gray-600"),children:["Assessment ID: ",L]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(l,{to:"/assess",className:"px-4 py-2 rounded-lg border border-blue-300 text-blue-600 hover:bg-blue-50 font-medium transition-colors",children:N("results.new_assessment_button")}),a.jsx(c,{})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[a.jsxs("div",{className:"rounded-xl border border-blue-200 bg-gradient-to-br from-blue-50 to-white p-6 shadow-sm",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"p-2 rounded-lg bg-blue-100",children:a.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z"})})}),a.jsx("div",{className:"text-sm font-medium text-blue-600",children:N("results.annual_rainfall")})]}),a.jsxs("div",{className:"text-2xl font-bold text-gray-800",children:[C.results.runoff.annual_rainfall_mm," mm"]}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Annual precipitation"})]}),a.jsxs("div",{className:"rounded-xl border border-cyan-200 bg-gradient-to-br from-cyan-50 to-white p-6 shadow-sm",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"p-2 rounded-lg bg-cyan-100",children:a.jsx("svg",{className:"w-5 h-5 text-cyan-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),a.jsx("div",{className:"text-sm font-medium text-cyan-600",children:N("results.runoff_volume")})]}),a.jsxs("div",{className:"text-2xl font-bold text-gray-800",children:[Math.round(C.results.runoff.annual_runoff_volume_liters)," L"]}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Collectable rainwater"})]}),a.jsxs("div",{className:"rounded-xl border border-green-200 bg-gradient-to-br from-green-50 to-white p-6 shadow-sm",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"p-2 rounded-lg bg-green-100",children:a.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),a.jsx("div",{className:"text-sm font-medium text-green-600",children:N("results.storage_capacity")})]}),a.jsxs("div",{className:"text-2xl font-bold text-gray-800",children:[Math.round(C.results.structure.storage_volume_liters)," L"]}),a.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Recommended storage"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"rounded-2xl border bg-white p-6 shadow",children:[a.jsx("h2",{className:"font-medium mb-2 text-gray-800",children:N("results.recommendations_title")}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("p",{children:[a.jsxs("span",{className:"font-semibold",children:[N("results.recommended_structure"),":"]})," ",C.results.structure.structure_type]}),a.jsxs("p",{children:[a.jsxs("span",{className:"font-semibold",children:[N("results.suggested_dimensions"),":"]})," ",a.jsx("span",{className:"font-mono text-xs",children:JSON.stringify(C.results.structure.dimensions)})]}),a.jsxs("p",{children:[a.jsxs("span",{className:"font-semibold",children:[N("results.potential_recharge"),":"]})," ",Math.round(C.results.recharge_potential_liters)," L/yr"]})]})]}),a.jsxs("div",{className:"rounded-2xl border bg-white p-6 shadow",children:[a.jsx("h2",{className:"font-medium mb-2 text-gray-800",children:N("results.chart_title")}),a.jsx("div",{className:"h-60",children:a.jsx(x,{width:"100%",height:"100%",children:a.jsxs(h,{data:$,children:[a.jsx(g,{strokeDasharray:"3 3"}),a.jsx(j,{dataKey:"name"}),a.jsx(p,{}),a.jsx(b,{}),a.jsx(f,{}),a.jsx(v,{type:"monotone",dataKey:"liters",name:"Liters",stroke:"#2563eb"})]})})})]})]}),a.jsxs("div",{className:"mt-10",children:[a.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-800",children:N("results.visualizer_title")}),a.jsx("div",{className:"rounded-2xl border bg-white p-6 shadow",children:a.jsx(i,{})})]}),a.jsxs("div",{className:"mt-8 p-6 rounded-xl border bg-gradient-to-r from-blue-50 to-cyan-50 border-blue-200",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[a.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Generate & Download Reports"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("button",{onClick:()=>z("ai"),disabled:B,className:"p-4 rounded-lg border border-blue-200 bg-white hover:bg-blue-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":N("aria.download_ai_pdf"),children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 rounded-lg bg-blue-100",children:a.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),a.jsxs("div",{className:"text-left",children:[a.jsx("div",{className:"font-medium text-gray-800",children:"AI Analysis Report"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Detailed AI insights"})]})]}),B&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-sm text-blue-600",children:[a.jsxs("svg",{className:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),N("results.preparing_pdf")]})]}),a.jsxs("button",{onClick:()=>z("guide"),disabled:D,className:"p-4 rounded-lg border border-cyan-200 bg-white hover:bg-cyan-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed","aria-label":N("aria.download_guide_pdf"),children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 rounded-lg bg-cyan-100",children:a.jsx("svg",{className:"w-5 h-5 text-cyan-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),a.jsxs("div",{className:"text-left",children:[a.jsx("div",{className:"font-medium text-gray-800",children:"Implementation Guide"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Step-by-step instructions"})]})]}),D&&a.jsxs("div",{className:"mt-2 flex items-center gap-2 text-sm text-cyan-600",children:[a.jsxs("svg",{className:"animate-spin w-4 h-4",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),N("results.preparing_guide")]})]}),a.jsx("button",{onClick:()=>{const e={assessment_id:L,timestamp:(new Date).toISOString(),user_info:{name:C.user_name,location:C.location_desc,coordinates:[C.latitude,C.longitude]},results:C.results,summary:{annual_rainfall:C.results.runoff.annual_rainfall_mm,runoff_volume:Math.round(C.results.runoff.annual_runoff_volume_liters),storage_capacity:Math.round(C.results.structure.storage_volume_liters),recharge_potential:Math.round(C.results.recharge_potential_liters)}},s=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),t=URL.createObjectURL(s),r=document.createElement("a");r.href=t,r.download=`rainwater_assessment_${L}_${Date.now()}.json`,r.click(),URL.revokeObjectURL(t)},className:"p-4 rounded-lg border border-green-200 bg-white hover:bg-green-50 transition-colors",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 rounded-lg bg-green-100",children:a.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})}),a.jsxs("div",{className:"text-left",children:[a.jsx("div",{className:"font-medium text-gray-800",children:"Data Export"}),a.jsx("div",{className:"text-sm text-gray-500",children:"JSON format"})]})]})})]})]})]}),a.jsx(u,{isListening:W,setIsListening:I,feedback:O})]})}export{N as Results,N as default};
